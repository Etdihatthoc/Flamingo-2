# Audio Flamingo Inference Code

This folder contains inference code of Audio Flamingo 2.

## Steps of Inference

- Replace L183 of ```inference.py``` with your HuggingFace api token. 
- The inference script uses 3B model by default. If you would like to try 0.5B or 1.5B, replace that in L183 of ```inference.py``` and L81-L82 of ```configs/inference.yaml```.
- The inference script uses top-K and top-P sampling by default (note that we use temperature=0.0 for benchmarking). You could replace sampling parameters in L232 of ```inference.py```.
- Prepare you audio paths and questions in ```inference.jsonl```.


Then, the following command will run inference on the examples in ```inference.jsonl```. 

- ```python inference.py --input inference.jsonl```

## License

- The code in this repo is under MIT license.
- The checkpoints are for non-commercial use only (see NVIDIA OneWay Noncommercial License). They are also subject to the [Qwen Research license](https://huggingface.co/Qwen/Qwen2.5-3B/blob/main/LICENSE), the [Terms of Use](https://openai.com/policies/terms-of-use) of the data generated by OpenAI, and the original licenses accompanying each training dataset.
- Notice: Audio Flamingo 2 is built with Qwen-2.5. Qwen is licensed under the Qwen RESEARCH LICENSE AGREEMENT, Copyright (c) Alibaba Cloud. All Rights Reserved.